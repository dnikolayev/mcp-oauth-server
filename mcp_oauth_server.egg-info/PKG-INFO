Metadata-Version: 2.4
Name: mcp_oauth_server
Version: 0.1.0
Summary: A generic implementation of a Model Context Protocol (MCP) server with built-in OAuth 2.0 support.
Author-email: Dmytro Nikolayev <dnikolayev@gmail.com>
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: mcp==1.24.0
Requires-Dist: sanic==25.3.0
Requires-Dist: click==8.3.1
Requires-Dist: aiohttp==3.13.2
Requires-Dist: pydantic==2.12.5
Requires-Dist: pydantic-settings==2.12.0
Requires-Dist: python-dotenv==1.2.1
Requires-Dist: uvloop; sys_platform != "win32"
Requires-Dist: PyYAML==6.0.3
Requires-Dist: redis==7.1.0
Requires-Dist: sqlalchemy[asyncio]
Requires-Dist: asyncpg
Provides-Extra: dev
Requires-Dist: aioresponses==0.7.8; extra == "dev"
Requires-Dist: sanic-testing; extra == "dev"
Requires-Dist: pytest==9.0.2; extra == "dev"
Requires-Dist: pytest-asyncio==1.3.0; extra == "dev"
Requires-Dist: pytest-cov==7.0.0; extra == "dev"
Requires-Dist: flake8; extra == "dev"
Requires-Dist: isort; extra == "dev"
Requires-Dist: pylint; extra == "dev"
Dynamic: license-file

# MCP OAuth Server for ChatGPT, Gemini, Claude and other MCP clients

![Build Status](https://github.com/yourusername/mcp-oauth-server/actions/workflows/ci.yml/badge.svg)


A generic implementation of a Model Context Protocol (MCP) server with built-in OAuth 2.0 support. It provides a solid foundation for building MCP servers that require robust authentication, whether acting as an OAuth 2.0 client to an upstream API or serving as a standalone authenticated agent.

> **Compatible with:** ChatGPT, Gemini, Claude, and other MCP-compliant clients.


## Features

- **OAuth 2.0 / 2.1 Support**: Built-in support for Authorization Code flow with PKCE (compliant with OAuth 2.1 best practices), Client Credentials, and token management.
- **Generic Tools**: Comes with example tools (`echo`, `add`) and a structure to easily add your own.
- **FastMCP & Sanic**: Built on top of `mcp` (FastMCP) and `sanic` for high-performance async HTTP serving.
- **Storage**: Pluggable storage backends (Redis, PostgreSQL, Memory) for sessions and token storage.
- **Configuration**: Fully configurable via environment variables (`MCP_SERVER_*`).

## Quick Start (local)

```bash
python3.14 -m venv venv && source venv/bin/activate
pip install -r requirements.txt
cp .env.example .env  # Adjust variables
python manage.py serve --debug
```

Default MCP endpoint: `http://127.0.0.1:8042/mcp`

## Docker

```bash
docker build -t mcp-oauth-server .
docker run --rm -p 8080:8080 mcp-oauth-server
```

## Tools

Includes basic tools for demonstration:
- `healthcheck()`: Checks server health.
- `echo(message)`: Echoes back the message.
- `add(a, b)`: Adds two numbers.

Extend `mcp_oauth_server/mcp_server.py` to add your own business logic tools.

## Configuration

See [Configuration.md](Configuration.md) for a detailed list of environment variables.

## Project Structure

- `mcp_oauth_server/`: Source code.
  - `mcp_server.py`: MCP tool definitions and server logic.
  - `http_server.py`: Sanic web server wrapper (handles OAuth, health, serving MCP).
  - `config.py`: Application configuration (Pydantic settings).
  - `auth.py` / `session_store.py`: Authentication and session management.
- `tests/`: Unit tests.

## Testing

The project maintains high standards for code quality and reliability, with **100% test coverage** across core modules.

To run the full test suite:

```bash
./test.sh
```

This script runs:
- **Pytest**: Unit and integration tests with `pytest-asyncio` and `pytest-cov`.
- **Flake8**: Code style enforcement.
- **Isort**: Import sorting checks.
- **Pylint**: Static code analysis.

The test suite covers:
- **OAuth Flows**: Authorization Code, PKCE, Client Credentials.
- **HTTP Server**: Endpoints, error handling, redirect logic.
- **Storage Backends**: In-memory, Redis, and mocked PostgreSQL interactions.
- **Configuration**: Environment variable parsing and validation.
- **Cookie Authentication**: Default and custom token extractors.

## License

[MIT](LICENSE)
